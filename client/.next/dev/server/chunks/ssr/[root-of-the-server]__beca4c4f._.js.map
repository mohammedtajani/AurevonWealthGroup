{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ADMIN/OneDrive/Desktop/Antigravity/AurevonWealthGroup/client/src/actions/investor-workflow.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { PrismaClient } from \"@prisma/client\";\r\nimport { revalidatePath } from \"next/cache\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\nconst prisma = new PrismaClient();\r\n\r\n// Helper to generate random password locally\r\nfunction generateRandomPassword(length = 12) {\r\n    const charset = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*\";\r\n    let retVal = \"\";\r\n    for (let i = 0, n = charset.length; i < length; ++i) {\r\n        retVal += charset.charAt(Math.floor(Math.random() * n));\r\n    }\r\n    return retVal;\r\n}\r\n\r\nexport async function registerInvestor(formData: FormData) {\r\n    const name = formData.get(\"name\") as string;\r\n    const email = formData.get(\"email\") as string;\r\n    const value = formData.get(\"investmentValue\") as string;\r\n\r\n    try {\r\n        await prisma.investor.create({\r\n            data: {\r\n                name,\r\n                email,\r\n                investmentValue: value,\r\n                status: \"Pending\",\r\n            },\r\n        });\r\n        return { success: true };\r\n    } catch (error) {\r\n        console.error(\"Registration failed:\", error);\r\n        return { success: false, error: \"Registration failed. Email might already be in use.\" };\r\n    }\r\n}\r\n\r\nexport async function approveInvestor(investorId: string) {\r\n    try {\r\n        // 1. Fetch Investor\r\n        const investor = await prisma.investor.findUnique({ where: { id: investorId } });\r\n        if (!investor) throw new Error(\"Investor not found\");\r\n\r\n        // 2. Generate Credentials\r\n        const password = generateRandomPassword();\r\n        const hashedPassword = await bcrypt.hash(password, 10);\r\n\r\n        // 3. Create User Account\r\n        const user = await prisma.user.create({\r\n            data: {\r\n                name: investor.name,\r\n                email: investor.email,\r\n                password: hashedPassword,\r\n                role: \"INVESTOR\",\r\n            },\r\n        });\r\n\r\n        // 4. Update Investor Record\r\n        await prisma.investor.update({\r\n            where: { id: investorId },\r\n            data: {\r\n                status: \"Active\",\r\n                userId: user.id,\r\n            },\r\n        });\r\n\r\n        // 5. Simulate Email Sending\r\n        console.log(\"---------------------------------------------------\");\r\n        console.log(`ðŸ“§ EMAIL SENT TO: ${investor.email}`);\r\n        console.log(`Subject: Welcome to Aurevon Wealth Group`);\r\n        console.log(`Message: Your account has been approved.`);\r\n        console.log(`Username: ${investor.email}`);\r\n        console.log(`Password: ${password}`);\r\n        console.log(\"---------------------------------------------------\");\r\n\r\n        revalidatePath(\"/admin/investors\");\r\n        return { success: true, password }; // Return password to show in admin UI if needed (optional)\r\n    } catch (error) {\r\n        console.error(\"Approval failed:\", error);\r\n        return { success: false, error: \"Failed to approve investor.\" };\r\n    }\r\n}\r\n\r\nexport async function rejectInvestor(investorId: string) {\r\n    try {\r\n        await prisma.investor.update({\r\n            where: { id: investorId },\r\n            data: { status: \"Rejected\" },\r\n        });\r\n        revalidatePath(\"/admin/investors\");\r\n        return { success: true };\r\n    } catch (error) {\r\n        return { success: false, error: \"Failed to reject investor.\" };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AACA;;;;;;AAEA,MAAM,SAAS,IAAI,6IAAY;AAE/B,6CAA6C;AAC7C,SAAS,uBAAuB,SAAS,EAAE;IACvC,MAAM,UAAU;IAChB,IAAI,SAAS;IACb,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,MAAM,EAAE,IAAI,QAAQ,EAAE,EAAG;QACjD,UAAU,QAAQ,MAAM,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK;IACxD;IACA,OAAO;AACX;AAEO,eAAe,iBAAiB,QAAkB;IACrD,MAAM,OAAO,SAAS,GAAG,CAAC;IAC1B,MAAM,QAAQ,SAAS,GAAG,CAAC;IAC3B,MAAM,QAAQ,SAAS,GAAG,CAAC;IAE3B,IAAI;QACA,MAAM,OAAO,QAAQ,CAAC,MAAM,CAAC;YACzB,MAAM;gBACF;gBACA;gBACA,iBAAiB;gBACjB,QAAQ;YACZ;QACJ;QACA,OAAO;YAAE,SAAS;QAAK;IAC3B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO;YAAE,SAAS;YAAO,OAAO;QAAsD;IAC1F;AACJ;AAEO,eAAe,gBAAgB,UAAkB;IACpD,IAAI;QACA,oBAAoB;QACpB,MAAM,WAAW,MAAM,OAAO,QAAQ,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE,IAAI;YAAW;QAAE;QAC9E,IAAI,CAAC,UAAU,MAAM,IAAI,MAAM;QAE/B,0BAA0B;QAC1B,MAAM,WAAW;QACjB,MAAM,iBAAiB,MAAM,4IAAM,CAAC,IAAI,CAAC,UAAU;QAEnD,yBAAyB;QACzB,MAAM,OAAO,MAAM,OAAO,IAAI,CAAC,MAAM,CAAC;YAClC,MAAM;gBACF,MAAM,SAAS,IAAI;gBACnB,OAAO,SAAS,KAAK;gBACrB,UAAU;gBACV,MAAM;YACV;QACJ;QAEA,4BAA4B;QAC5B,MAAM,OAAO,QAAQ,CAAC,MAAM,CAAC;YACzB,OAAO;gBAAE,IAAI;YAAW;YACxB,MAAM;gBACF,QAAQ;gBACR,QAAQ,KAAK,EAAE;YACnB;QACJ;QAEA,4BAA4B;QAC5B,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC,CAAC,kBAAkB,EAAE,SAAS,KAAK,EAAE;QACjD,QAAQ,GAAG,CAAC,CAAC,wCAAwC,CAAC;QACtD,QAAQ,GAAG,CAAC,CAAC,wCAAwC,CAAC;QACtD,QAAQ,GAAG,CAAC,CAAC,UAAU,EAAE,SAAS,KAAK,EAAE;QACzC,QAAQ,GAAG,CAAC,CAAC,UAAU,EAAE,UAAU;QACnC,QAAQ,GAAG,CAAC;QAEZ,IAAA,+IAAc,EAAC;QACf,OAAO;YAAE,SAAS;YAAM;QAAS,GAAG,2DAA2D;IACnG,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO;YAAE,SAAS;YAAO,OAAO;QAA8B;IAClE;AACJ;AAEO,eAAe,eAAe,UAAkB;IACnD,IAAI;QACA,MAAM,OAAO,QAAQ,CAAC,MAAM,CAAC;YACzB,OAAO;gBAAE,IAAI;YAAW;YACxB,MAAM;gBAAE,QAAQ;YAAW;QAC/B;QACA,IAAA,+IAAc,EAAC;QACf,OAAO;YAAE,SAAS;QAAK;IAC3B,EAAE,OAAO,OAAO;QACZ,OAAO;YAAE,SAAS;YAAO,OAAO;QAA6B;IACjE;AACJ;;;IA9EsB;IAqBA;IA8CA;;AAnEA,+OAAA;AAqBA,+OAAA;AA8CA,+OAAA"}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ADMIN/OneDrive/Desktop/Antigravity/AurevonWealthGroup/client/.next-internal/server/app/register/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {registerInvestor as '40153de3690f4dae6302f08242581475b8d7a6615b'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}